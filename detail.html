<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° - Trade Gold</title>
    <link rel="icon" type="image/png" href="image/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>:root{--gold-primary:#EDBF43;--gold-light:#FFD700;--gold-dark:#B8860B;--navy:#1E3A8A;--navy-medium:#1E40AF;--white:#ffffff;--gray-light:#f8f9fa;--gray-medium:#e9ecef;--text-dark:#2c3e50;--sky-blue:#87CEEB;--sky-light:#A3DFF8;--shadow:0 10px 30px rgba(0,0,0,0.1);--green:#059669;--red:#dc2626}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Kanit',sans-serif;background:linear-gradient(180deg,var(--sky-light) 0%,var(--white) 100%);color:var(--text-dark);line-height:1.8}.breadcrumb{max-width:1200px;margin:2rem auto;padding:0 2rem;display:flex;align-items:center;gap:0.5rem;font-size:0.9rem;color:#6b7280}.breadcrumb a{color:var(--navy);text-decoration:none;transition:color 0.3s}.breadcrumb a:hover{color:var(--gold-primary)}.breadcrumb span{color:#9ca3af}.nav-wrapper{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;gap:2rem;position:relative;padding-top:2rem}.table-of-contents{width:320px;flex-shrink:0;position:sticky;top:100px;align-self:flex-start;background:var(--white);border-radius:15px;padding:1.5rem;box-shadow:var(--shadow);max-height:calc(100vh - 120px);overflow-y:auto}.toc-title{font-size:1.2rem;font-weight:600;color:var(--navy);margin-bottom:1rem;padding-bottom:0.5rem;border-bottom:2px solid var(--gold-primary)}.toc-list{list-style:none;padding:0}.toc-list li{margin-bottom:0.5rem}.toc-list a{display:block;color:var(--text-dark);text-decoration:none;padding:0.5rem 0.75rem;border-radius:8px;transition:all 0.3s;font-size:0.95rem;border:2px solid transparent}.toc-list a:hover{background:var(--gray-light);color:var(--navy);padding-left:1rem;border-color:var(--gray-medium)}.toc-list a.active{background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);color:var(--navy);font-weight:600;border:2px solid var(--gold-primary);box-shadow:0 2px 8px rgba(237,191,67,0.3)}.toc-list a.active:hover{padding-left:0.75rem;border-color:var(--gold-dark)}.toc-item-parent{position:relative}.toc-item-parent>.toc-parent-wrapper{display:flex;align-items:center;justify-content:space-between;gap:0.5rem;border-radius:8px;transition:all 0.3s;border:2px solid transparent}.toc-item-parent>.toc-parent-wrapper:hover{background:var(--gray-light);border-color:var(--gray-medium)}.toc-item-parent>.toc-parent-wrapper.active{background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);border:2px solid var(--gold-primary);box-shadow:0 2px 8px rgba(237,191,67,0.3)}.toc-item-parent>.toc-parent-wrapper.active:hover{border-color:var(--gold-dark)}.toc-item-parent>.toc-parent-wrapper>a{flex:1;border:none !important;background:none !important;box-shadow:none !important;padding:0.5rem 0.75rem}.toc-item-parent>.toc-parent-wrapper>a:hover{background:none !important;padding-left:0.75rem !important}.toc-item-parent>.toc-parent-wrapper.active>a{color:var(--navy);font-weight:600}.toc-toggle-btn{background:none;border:none;color:var(--navy);font-size:0.9rem;cursor:pointer;padding:0.5rem 0.75rem;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all 0.3s;flex-shrink:0}.toc-toggle-btn:hover{background:var(--gray-light)}.toc-toggle-btn.collapsed{transform:rotate(-90deg)}.toc-submenu{list-style:none;padding:0.75rem;padding-left:1.5rem;margin-top:0.5rem;margin-bottom:0.5rem;overflow:hidden;max-height:500px;transition:max-height 0.3s ease-in-out,opacity 0.3s ease-in-out;opacity:1;background:var(--gray-light);border:2px solid var(--gray-medium);border-radius:8px}.toc-submenu.collapsed{max-height:0;opacity:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;border-color:transparent}.toc-submenu li{margin-bottom:0.25rem}.toc-submenu li:last-child{margin-bottom:0}.toc-submenu a{padding:0.4rem 0.5rem;font-size:0.9rem}.toc-toggle{display:none;position:fixed;bottom:2rem;right:2rem;background:var(--gold-primary);color:var(--navy);border:none;border-radius:50%;width:60px;height:60px;font-size:1.5rem;box-shadow:0 4px 15px rgba(0,0,0,0.3);cursor:pointer;z-index:1000;transition:all 0.3s}.toc-toggle:hover{transform:scale(1.1)}.article-container{flex:1;margin-bottom:4rem}.article-category{position:absolute;top:12px;right:12px;display:inline-block;background:var(--navy);color:var(--white);padding:0.5rem 1.5rem;border-radius:25px;font-size:0.9rem;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.3);z-index:10}.article-meta{display:flex;align-items:center;gap:2rem;color:var(--white);font-size:0.95rem}.meta-item{display:flex;align-items:center;gap:0.5rem}.article-featured-image{width:100%;height:450px;background:url('Image/Book.png') center center/cover no-repeat,linear-gradient(135deg,var(--navy) 0%,var(--navy-medium) 100%);border-radius:20px;display:flex;flex-direction:column;justify-content:flex-end;padding:3rem;margin-bottom:-50px;overflow:hidden;position:relative;z-index:5}.article-image-meta{position:absolute;bottom:15px;right:20px;display:flex;align-items:center;gap:1.5rem;color:var(--white);font-size:0.9rem;background:rgba(0,0,0,0.5);padding:0.75rem 1.5rem;border-radius:50px;backdrop-filter:blur(10px);z-index:10}.article-image-meta .meta-item{display:flex;align-items:center;gap:0.5rem}.article-header-content{position:relative;z-index:2;display:none}.article-content{background:var(--white);border-radius:20px;padding:3rem;box-shadow:var(--shadow);margin-bottom:0;position:relative}.article-content h2{font-size:2rem;color:var(--navy);margin:2rem 0 1rem;padding-bottom:0.5rem;border-bottom:3px solid var(--gold-primary);scroll-margin-top:120px}.article-content h3{font-size:1.5rem;color:var(--navy);margin:1.5rem 0 1rem;scroll-margin-top:120px}.article-content p{margin-bottom:1.5rem;font-size:1.1rem;line-height:1.8;color:var(--text-dark)}.article-content ul,.article-content ol{margin:1.5rem 0;padding-left:2rem}.article-content li{margin-bottom:0.75rem;font-size:1.05rem;line-height:1.8}.article-content strong{color:var(--navy);font-weight:600}.article-content blockquote{background:var(--gray-light);border-left:5px solid var(--gold-primary);padding:1.5rem;margin:2rem 0;border-radius:10px;font-style:italic;color:#555}.article-content table{width:100%;border-collapse:collapse;margin:2rem 0}.article-content table th,.article-content table td{padding:0.75rem;border:1px solid #ddd}.article-content table thead{background:var(--navy);color:white}.highlight-box{background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);border:2px solid var(--gold-primary);border-radius:15px;padding:2rem;margin:2rem 0;box-shadow:0 4px 15px rgba(237,191,67,0.2)}.highlight-box h4{color:var(--navy);font-size:1.3rem;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem}.highlight-box p,.highlight-box li{color:var(--text-dark)}.loading-container{max-width:1200px;margin:4rem auto;text-align:center;padding:0 2rem}.loading-content{background:white;padding:3rem 2rem;border-radius:15px;box-shadow:0 4px 20px rgba(0,0,0,0.08)}.loading-spinner{border:4px solid #f3f3f3;border-top:4px solid var(--gold-primary);border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.error-container{max-width:1200px;margin:4rem auto;padding:0 2rem}.error-content{background:#fee;border:2px solid #fcc;border-radius:15px;padding:2rem;text-align:center}.error-content h3{color:var(--red);margin-bottom:1rem}@media (max-width:1024px){.nav-wrapper{flex-direction:column}.table-of-contents{position:fixed;top:0;left:-100%;width:300px;height:100vh;max-height:100vh;z-index:999;transition:left 0.3s;border-radius:0}.table-of-contents.active{left:0}.toc-toggle{display:block}.toc-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:998}.toc-overlay.active{display:block}}@media (max-width:768px){.article-content-header h1{font-size:1.8rem}.article-content-meta{flex-direction:column;align-items:flex-start;gap:0.5rem}.article-content{padding:2rem 1.5rem}.article-content h2{font-size:1.5rem}.article-content h3{font-size:1.3rem}.article-content p{font-size:1rem}.article-featured-image{height:360px;padding:2rem}.article-image-meta{bottom:15px;right:15px;flex-direction:column;gap:0.5rem;font-size:0.85rem;padding:0.6rem 1rem}}</style>
</head>
<body>
    <div id="navbar-placeholder"></div>

    <div class="breadcrumb">
        <a href="home.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <span>‚Ä∫</span>
        <a href="blog.html">‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</a>
        <span>‚Ä∫</span>
        <span id="breadcrumbTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</span>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="loading-container">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p style="color: #666;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°...</p>
        </div>
    </div>

    <!-- Error State -->
    <div id="errorState" class="error-container" style="display: none;">
        <div class="error-content">
            <h3>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ</h3>
            <p id="errorMessage">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á<a href="news.html" style="color: var(--navy); font-weight: 600;">‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</a></p>
        </div>
    </div>

    <!-- Main Content with Navigation -->
    <div class="nav-wrapper" id="navWrapper" style="display: none;">
        <!-- Table of Contents -->
        <aside class="table-of-contents" id="tocSidebar">
            <h3 class="toc-title">üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç</h3>
            <ul class="toc-list" id="tocList">
                <!-- TOC ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ -->
            </ul>
        </aside>

        <!-- Article Content -->
        <div class="article-container">
            <div class="article-featured-image" id="articleImage">
                <span class="article-category" id="articleCategory">üìò Guide Book</span>
                
                <!-- Meta info ‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ -->
                <div class="article-image-meta">
                    <div class="meta-item">
                        <span id="articleDateImage">20/12/2025</span>
                    </div>
                    <div class="meta-item">
                        <span>‡πÇ‡∏î‡∏¢ Trade Gold Team</span>
                    </div>
                </div>
            </div>

            <div class="article-content">
                <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° -->
                <div id="articleContent">
                    <!-- Content ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <!-- Switch Button Placeholder -->
    <div id="switch-button-placeholder"></div>

    <!-- Mobile TOC Toggle Button -->
    <button class="toc-toggle" id="tocToggle" aria-label="Toggle Table of Contents">
        üìã
    </button>

    <!-- Mobile TOC Overlay -->
    <div class="toc-overlay" id="tocOverlay"></div>

    <script>
        // API URL
        const API_URL = 'https://script.google.com/macros/s/AKfycbzTIMUcEl49nXGRMQk_L_TI1XFD28gUNyMt0IXKVWnDiPnV5GorIEEPMswp-Gsv0r1Bhw/exec';

        // Get article ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const articleId = urlParams.get('id');

        // Convert Google Drive URL to direct link
        function convertGoogleDriveUrl(url) {
            if (!url || !url.includes('drive.google.com')) {
                return url;
            }
            
            console.log('Converting URL:', url);
            
            let fileId = '';
            
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 1: /file/d/FILE_ID/view
            const match1 = url.match(/\/file\/d\/([^\/]+)/);
            if (match1) {
                fileId = match1[1];
                console.log('Match pattern 1, fileId:', fileId);
            }
            
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 2: /d/FILE_ID/
            if (!fileId) {
                const match2 = url.match(/\/d\/([^\/\?]+)/);
                if (match2) {
                    fileId = match2[1];
                    console.log('Match pattern 2, fileId:', fileId);
                }
            }
            
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 3: id=FILE_ID
            if (!fileId) {
                const match3 = url.match(/[?&]id=([^&]+)/);
                if (match3) {
                    fileId = match3[1];
                    console.log('Match pattern 3, fileId:', fileId);
                }
            }
            
            if (fileId) {
                // ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
                const methods = [
                    `https://lh3.googleusercontent.com/d/${fileId}`,  // ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                    `https://drive.google.com/thumbnail?id=${fileId}&sz=w2000`,  // thumbnail API
                    `https://drive.google.com/uc?export=view&id=${fileId}`  // ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏î‡∏¥‡∏°
                ];
                
                const directUrl = methods[0]; // ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏£‡∏Å
                console.log('Converted to:', directUrl);
                return directUrl;
            }
            
            console.log('Could not extract fileId, returning original URL');
            return url;
        }

        // Generate Table of Contents
        function generateTOC() {
            const content = document.getElementById('articleContent');
            const tocList = document.getElementById('tocList');
            const headings = content.querySelectorAll('h2, h3');
            
            if (headings.length === 0) {
                document.getElementById('tocSidebar').style.display = 'none';
                return;
            }

            tocList.innerHTML = '';
            let currentH2Item = null;
            let currentSubmenu = null;

            headings.forEach((heading, index) => {
                // Add ID if not exists
                if (!heading.id) {
                    heading.id = `section-${index}`;
                }

                if (heading.tagName === 'H2') {
                    // Check if next heading is H3
                    const nextHeading = headings[index + 1];
                    const hasSubmenu = nextHeading && nextHeading.tagName === 'H3';

                    if (hasSubmenu) {
                        // Create parent with dropdown
                        currentH2Item = document.createElement('li');
                        currentH2Item.className = 'toc-item-parent';

                        const wrapper = document.createElement('div');
                        wrapper.className = 'toc-parent-wrapper';

                        const link = document.createElement('a');
                        link.href = `#${heading.id}`;
                        link.textContent = heading.textContent;

                        const toggleBtn = document.createElement('button');
                        toggleBtn.className = 'toc-toggle-btn collapsed';
                        toggleBtn.setAttribute('aria-label', 'Toggle submenu');
                        toggleBtn.textContent = '‚ñº';

                        wrapper.appendChild(link);
                        wrapper.appendChild(toggleBtn);
                        currentH2Item.appendChild(wrapper);

                        currentSubmenu = document.createElement('ul');
                        currentSubmenu.className = 'toc-submenu collapsed';
                        currentH2Item.appendChild(currentSubmenu);

                        tocList.appendChild(currentH2Item);
                    } else {
                        // Regular H2
                        const li = document.createElement('li');
                        const link = document.createElement('a');
                        link.href = `#${heading.id}`;
                        link.textContent = heading.textContent;
                        li.appendChild(link);
                        tocList.appendChild(li);
                        currentH2Item = null;
                        currentSubmenu = null;
                    }
                } else if (heading.tagName === 'H3' && currentSubmenu) {
                    // Add H3 to submenu
                    const li = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = `#${heading.id}`;
                    link.textContent = heading.textContent;
                    li.appendChild(link);
                    currentSubmenu.appendChild(li);
                }
            });

            setupTOCFunctionality();
        }

        // Setup TOC event listeners
        function setupTOCFunctionality() {
            const tocLinks = document.querySelectorAll('.toc-list a');
            const tocToggle = document.getElementById('tocToggle');
            const tocSidebar = document.getElementById('tocSidebar');
            const tocOverlay = document.getElementById('tocOverlay');

            // Dropdown toggle
            const toggleButtons = document.querySelectorAll('.toc-toggle-btn');
            toggleButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    
                    const parentLi = this.closest('.toc-item-parent');
                    const submenu = parentLi.querySelector('.toc-submenu');
                    
                    if (submenu) {
                        submenu.classList.toggle('collapsed');
                        this.classList.toggle('collapsed');
                    }
                });
            });

            // Smooth scroll
            tocLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô submenu ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    const isSubmenuLink = this.closest('.toc-submenu');
                    
                    // Remove active class
                    tocLinks.forEach(l => l.classList.remove('active'));
                    document.querySelectorAll('.toc-parent-wrapper').forEach(w => w.classList.remove('active'));
                    
                    // ‡∏õ‡∏¥‡∏î dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢
                    if (!isSubmenuLink) {
                        document.querySelectorAll('.toc-submenu').forEach(submenu => {
                            submenu.classList.add('collapsed');
                        });
                        document.querySelectorAll('.toc-toggle-btn').forEach(btn => {
                            btn.classList.add('collapsed');
                        });
                    }
                    
                    // Add active class
                    const parentWrapper = this.closest('.toc-parent-wrapper');
                    if (parentWrapper) {
                        parentWrapper.classList.add('active');
                        
                        // ‡πÄ‡∏õ‡∏¥‡∏î dropdown ‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ submenu
                        const parentLi = parentWrapper.closest('.toc-item-parent');
                        if (parentLi) {
                            const submenu = parentLi.querySelector('.toc-submenu');
                            const toggleBtn = parentLi.querySelector('.toc-toggle-btn');
                            
                            if (submenu) {
                                submenu.classList.remove('collapsed');
                                if (toggleBtn) {
                                    toggleBtn.classList.remove('collapsed');
                                }
                            }
                        }
                    } else {
                        this.classList.add('active');
                        
                        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô submenu ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î parent dropdown ‡∏î‡πâ‡∏ß‡∏¢
                        if (isSubmenuLink) {
                            const parentLi = this.closest('.toc-item-parent');
                            if (parentLi) {
                                const parentWrapper = parentLi.querySelector('.toc-parent-wrapper');
                                const submenu = parentLi.querySelector('.toc-submenu');
                                const toggleBtn = parentLi.querySelector('.toc-toggle-btn');
                                
                                if (parentWrapper) {
                                    parentWrapper.classList.add('active');
                                }
                                if (submenu) {
                                    submenu.classList.remove('collapsed');
                                }
                                if (toggleBtn) {
                                    toggleBtn.classList.remove('collapsed');
                                }
                            }
                        }
                    }
                    
                    const targetId = this.getAttribute('href');
                    const target = document.querySelector(targetId);
                    
                    if (target) {
                        const offset = 120;
                        const targetPosition = target.getBoundingClientRect().top + window.pageYOffset - offset;
                        
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                        
                        // Close mobile menu
                        if (window.innerWidth <= 1024) {
                            tocSidebar.classList.remove('active');
                            tocOverlay.classList.remove('active');
                        }
                    }
                });
            });

            // Mobile toggle
            if (tocToggle) {
                tocToggle.addEventListener('click', function() {
                    tocSidebar.classList.toggle('active');
                    tocOverlay.classList.toggle('active');
                });
            }

            if (tocOverlay) {
                tocOverlay.addEventListener('click', function() {
                    tocSidebar.classList.remove('active');
                    tocOverlay.classList.remove('active');
                });
            }
        }

        // Load article
        async function loadArticle() {
            if (!articleId) {
                showError('‡πÑ‡∏°‡πà‡∏û‡∏ö ID ‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏ ID ‡πÉ‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå (‡πÄ‡∏ä‡πà‡∏ô ?id=1)');
                return;
            }

            try {
                console.log('Loading article with ID:', articleId);
                const response = await fetch(`${API_URL}?id=${articleId}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('=== API Response ===');
                console.log('Full data:', data);
                console.log('==================');

                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                let articlesList = null;
                
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 1: { articles: [...] }
                if (data && data.articles && Array.isArray(data.articles)) {
                    console.log('‚úÖ Found data.articles array');
                    articlesList = data.articles;
                }
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 2: data ‡πÄ‡∏õ‡πá‡∏ô Array ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
                else if (Array.isArray(data)) {
                    console.log('‚úÖ Data is Array directly');
                    articlesList = data;
                }
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 3: { article: {...} }
                else if (data && data.article) {
                    console.log('‚úÖ Found data.article (single object)');
                    displayArticle(data.article);
                    return;
                }
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 4: data ‡πÄ‡∏õ‡πá‡∏ô object ‡∏ó‡∏µ‡πà‡∏°‡∏µ title
                else if (data && (data.title || data.Title)) {
                    console.log('‚úÖ Found direct article object');
                    displayArticle(data);
                    return;
                }

                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å Array
                if (articlesList && articlesList.length > 0) {
                    console.log(`Searching for article ID: ${articleId} in ${articlesList.length} articles`);
                    console.log('Available IDs:', articlesList.map(a => a.ID || a.id));
                    
                    // ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ID ‡∏ó‡∏±‡πâ‡∏á uppercase ‡πÅ‡∏•‡∏∞ lowercase
                    const article = articlesList.find(a => {
                        const aId = a.ID || a.id;
                        return String(aId) === String(articleId);
                    });
                    
                    if (article) {
                        console.log('‚úÖ Found article:', article);
                        displayArticle(article);
                    } else {
                        console.log('‚ùå Article not found');
                        const availableIds = articlesList.map(a => a.ID || a.id).join(', ');
                        showError(`‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° ID: ${articleId}<br><br>üìã ID ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö: ${availableIds}`);
                    }
                } else {
                    console.log('‚ùå No articles found in response');
                    showError('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö');
                }
            } catch (error) {
                console.error('Error loading article:', error);
                showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°: ' + error.message);
            }
        }

        // Display article
        function displayArticle(article) {
            console.log('Displaying article:', article);
            
            // Hide loading, show content first
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('navWrapper').style.display = 'flex';

            // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏±‡πâ‡∏á uppercase ‡πÅ‡∏•‡∏∞ lowercase
            const title = article.Title || article.title || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°';
            const category = article.Category || article.category || 'üìò Guide Book';
            const date = article.Date || article.date || '-';
            const content = article.Content || article.content || '';
            const image = article.Image || article.image || '';

            console.log('Article data:', { title, category, date, hasContent: !!content, hasImage: !!image });

            // Set header data
            const articleTitleEl = document.getElementById('articleTitle');
            if (articleTitleEl) {
                articleTitleEl.textContent = title;
            }
            
            const articleCategoryEl = document.getElementById('articleCategory');
            if (articleCategoryEl) {
                articleCategoryEl.textContent = category;
            }
            
            const articleDateImageEl = document.getElementById('articleDateImage');
            if (articleDateImageEl) {
                articleDateImageEl.textContent = date;
            }
            
            const breadcrumbTitleEl = document.getElementById('breadcrumbTitle');
            if (breadcrumbTitleEl) {
                breadcrumbTitleEl.textContent = title;
            }
            
            // Set featured image (‡πÅ‡∏Ñ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏â‡∏¢‡πÜ)
            const articleImage = document.getElementById('articleImage');
            if (image) {
                const fileId = extractFileId(image);
                console.log('Original image URL:', image);
                console.log('Extracted fileId:', fileId);
                
                if (fileId) {
                    // ‡∏•‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö
                    const imageUrls = [
                        `https://lh3.googleusercontent.com/d/${fileId}`,
                        `https://drive.google.com/thumbnail?id=${fileId}&sz=w2000`,
                        `https://drive.google.com/uc?export=view&id=${fileId}`
                    ];
                    
                    tryLoadImage(imageUrls, 0);
                    
                    function tryLoadImage(urls, index) {
                        if (index >= urls.length) {
                            console.log('‚ùå All image URLs failed, using fallback gradient');
                            articleImage.style.backgroundImage = `linear-gradient(135deg, var(--navy) 0%, var(--navy-medium) 100%)`;
                            return;
                        }
                        
                        const currentUrl = urls[index];
                        console.log(`Trying URL ${index + 1}/${urls.length}:`, currentUrl);
                        
                        const img = new Image();
                        img.onload = function() {
                            console.log(`‚úÖ Image loaded successfully with method ${index + 1}`);
                            articleImage.style.backgroundImage = `url('${currentUrl}')`;
                            articleImage.style.backgroundSize = 'cover';
                            articleImage.style.backgroundPosition = 'center';
                            articleImage.style.backgroundRepeat = 'no-repeat';
                        };
                        img.onerror = function() {
                            console.log(`‚ùå Method ${index + 1} failed, trying next...`);
                            tryLoadImage(urls, index + 1);
                        };
                        img.src = currentUrl;
                    }
                } else {
                    console.log('‚ùå Could not extract fileId from URL');
                    articleImage.style.backgroundImage = `linear-gradient(135deg, var(--navy) 0%, var(--navy-medium) 100%)`;
                }
            } else {
                console.log('No image URL provided');
                articleImage.style.backgroundImage = `linear-gradient(135deg, var(--navy) 0%, var(--navy-medium) 100%)`;
            }
            
            // Helper function to extract fileId
            function extractFileId(url) {
                if (!url) return null;
                
                const match1 = url.match(/\/file\/d\/([^\/]+)/);
                if (match1) return match1[1];
                
                const match2 = url.match(/\/d\/([^\/\?]+)/);
                if (match2) return match2[1];
                
                const match3 = url.match(/[?&]id=([^&]+)/);
                if (match3) return match3[1];
                
                return null;
            }

            // Set content
            const contentDiv = document.getElementById('articleContent');
            if (content) {
                console.log('Content length:', content.length);
                // ‡πÅ‡∏õ‡∏•‡∏á \n ‡πÄ‡∏õ‡πá‡∏ô <br> ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
                const processedContent = content.replace(/\\n/g, '\n');
                contentDiv.innerHTML = processedContent;
            } else {
                console.log('No content found');
                contentDiv.innerHTML = '<p style="padding: 2rem; text-align: center; color: #666;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</p>';
            }

            // Generate TOC
            setTimeout(() => {
                generateTOC();
            }, 100);

            // Update page title
            document.title = `${title} - Trade Gold`;
        }

        // Show error
        function showError(message) {
            console.error('Error:', message);
            document.getElementById('loadingState').style.display = 'none';
            const errorState = document.getElementById('errorState');
            errorState.style.display = 'block';
            document.getElementById('errorMessage').innerHTML = `${message}<br><br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á<a href="news.html" style="color: var(--navy); font-weight: 600;">‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</a>`;
        }

        // Load on page ready
        document.addEventListener('DOMContentLoaded', function() {
            loadArticle();
        });
    </script>

    <!-- Load Shared Components -->
    <script>
        window.GUIDE_API_URL = 'https://script.google.com/macros/s/AKfycbzTIMUcEl49nXGRMQk_L_TI1XFD28gUNyMt0IXKVWnDiPnV5GorIEEPMswp-Gsv0r1Bhw/exec';
        
        fetch('index.html')
            .then(response => response.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                const navbarTemplate = doc.getElementById('navbar-template');
                if (navbarTemplate) {
                    const navbarContent = navbarTemplate.content.cloneNode(true);
                    document.getElementById('navbar-placeholder').appendChild(navbarContent);
                    
                    const currentPage = window.location.pathname.split('/').pop().replace('.html', '') || 'home';
                    const navLinks = document.querySelectorAll('.nav-menu a');
                    navLinks.forEach(link => {
                        const pageName = link.getAttribute('data-page');
                        if (pageName === currentPage) {
                            link.classList.add('active');
                        }
                    });
                }
                
                const footerTemplate = doc.getElementById('footer-template');
                if (footerTemplate) {
                    const footerContent = footerTemplate.content.cloneNode(true);
                    document.getElementById('footer-placeholder').appendChild(footerContent);
                }
                
                const sharedStyles = doc.getElementById('shared-styles');
                if (sharedStyles && !document.getElementById('shared-styles-injected')) {
                    const styleElement = document.createElement('style');
                    styleElement.id = 'shared-styles-injected';
                    styleElement.textContent = sharedStyles.textContent;
                    document.head.appendChild(styleElement);
                }
                
                const sharedScript = doc.getElementById('shared-components-script');
                if (sharedScript && !window.sharedScriptLoaded) {
                    const scriptElement = document.createElement('script');
                    scriptElement.textContent = sharedScript.textContent;
                    document.body.appendChild(scriptElement);
                    window.sharedScriptLoaded = true;
                }
                
                // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≤‡∏° Mode
                setTimeout(() => {
                    function updateTextByMode() {
                        const isSilverMode = localStorage.getItem('tradeSiteMode') === 'silver';
                        
                        const textReplacements = {
                            '‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥': isSilverMode ? '‡πÄ‡∏á‡∏¥‡∏ô' : '‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥',
                            '‡∏ó‡∏≠‡∏á': isSilverMode ? '‡πÄ‡∏á‡∏¥‡∏ô' : '‡∏ó‡∏≠‡∏á',
                            'Gold': isSilverMode ? 'Silver' : 'Gold'
                        };
                        
                        function replaceText(element) {
                            if (element.nodeType === Node.TEXT_NODE) {
                                let text = element.textContent;
                                let modified = false;
                                
                                for (const [oldText, newText] of Object.entries(textReplacements)) {
                                    if (text.includes(oldText)) {
                                        text = text.replace(new RegExp(oldText, 'g'), newText);
                                        modified = true;
                                    }
                                }
                                
                                if (modified) {
                                    element.textContent = text;
                                }
                            } else if (element.nodeType === Node.ELEMENT_NODE && 
                                       element.tagName !== 'SCRIPT' && 
                                       element.tagName !== 'STYLE' &&
                                       !element.classList.contains('no-translate')) {
                                for (const child of element.childNodes) {
                                    replaceText(child);
                                }
                            }
                        }
                        
                        const mainContent = document.body;
                        if (mainContent) {
                            replaceText(mainContent);
                        }
                        
                        console.log(`‚úÖ Detail page text updated to ${isSilverMode ? 'Silver' : 'Gold'} mode`);
                    }
                    
                    updateTextByMode();
                    
                    window.addEventListener('modeChanged', () => {
                        updateTextByMode();
                    });
                }, 600);
            })
            .catch(error => console.error('Error loading components:', error));
    </script>

</body>
</html>